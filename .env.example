# =============================================================================
# canopy-indexer Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Multi-Chain Configuration
# -----------------------------------------------------------------------------

# Chains are hardcoded in internal/config/config.go (MockChains function)
# Default: 100 chains with IDs 1000-1099 on ports 60000-60099

# -----------------------------------------------------------------------------
# WebSocket Configuration
# -----------------------------------------------------------------------------

# Enable WebSocket for real-time block notifications
# Set to false for mock testing (uses backfill HTTP polling instead)
WS_ENABLED=false

# Maximum reconnection attempts before giving up
WS_MAX_RETRIES=25

# Base delay between reconnection attempts (linear backoff)
WS_RECONNECT_DELAY=1s

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------

# PostgreSQL connection URL
# Note: Uses port 5434 to avoid conflict with launchpad on 5432
POSTGRES_URL=postgres://canopy-indexer:canopy-indexer123@localhost:5434/canopy-indexer?sslmode=disable

# -----------------------------------------------------------------------------
# Redis Configuration (for Watermill message queue)
# -----------------------------------------------------------------------------

# Redis connection URL
# Format: redis://[:password@]host:port[/db]
# Note: Uses port 6381 to avoid conflict with other redis instances
REDIS_URL=redis://:canopy-redis-dev@localhost:6381/0

# Topic name for block indexing jobs
BLOCKS_TOPIC=blocks-to-index

# Consumer group name (allows multiple workers to share the load)
CONSUMER_GROUP=indexer-workers

# -----------------------------------------------------------------------------
# RPC Rate Limiting
# -----------------------------------------------------------------------------

# Requests per second limit
RPC_RPS=500

# Burst size (max concurrent requests)
RPC_BURST=1000

# -----------------------------------------------------------------------------
# Worker Configuration
# -----------------------------------------------------------------------------

# Number of concurrent block processing workers
WORKER_CONCURRENCY=1

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------

# Log level: debug, info, warn, error
LOG_LEVEL=info

# =============================================================================
# Docker/K8s Overrides
# =============================================================================

# When running in Docker, use host.docker.internal instead of localhost:
# POSTGRES_URL=postgres://canopy-indexer:canopy-indexer123@host.docker.internal:5433/canopy-indexer?sslmode=disable
# REDIS_URL=redis://:canopy-redis-dev@host.docker.internal:6380/0

# When running via Tilt/docker-compose, use service names:
# POSTGRES_URL=postgres://canopy-indexer:canopy-indexer123@postgres:5432/canopy-indexer?sslmode=disable
# REDIS_URL=redis://:canopy-redis-dev@redis:6379/0
